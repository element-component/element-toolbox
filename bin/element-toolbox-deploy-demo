#!/usr/bin/env node

var fs = require('fs')
var ghpages = require('gh-pages')
var exec = require('./../lib/exec')
var log = require('./../lib/log')
var cwd = require('./../lib/cwd')
var dir = cwd('example/', 'build')
var cacheDir = cwd('.cache')

if (!fs.existsSync(cacheDir)){
  fs.mkdirSync(cacheDir)
}

exec('cooking', ['build', '-c', 'cooking.demo.js'])

if (!fs.existsSync(dir)) {
  log.error(dir + '  does not exist.')
}

ghpages.publish(dir, {
  clone: '.cache',
  logger: function(message) {
    log.info(message)
  }
}, function(err) {
  if (err) {
    log.error(err)
  }
  log.success('DONE!')
})
